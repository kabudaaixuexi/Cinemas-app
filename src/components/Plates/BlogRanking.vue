<template>
  <section v-loading="loading" :element-loading-svg="svg"
    element-loading-svg-view-box="-10, -10, 50, 50" class="blog-ranking-container">
    <header v-if="[6].includes(type)" :class="`blog-ranking-container__header hot`">
      {{ typeEnum.get(type) }}
    </header>
    <header v-if="[7].includes(type)" :class="`blog-ranking-container__header pry`">
      {{ typeEnum.get(type) }}
    </header>
    <header v-if="[8].includes(type)" :class="`blog-ranking-container__header link`">
      {{ typeEnum.get(type) }}
    </header>
    <header v-if="[9].includes(type)" :class="`blog-ranking-container__header random`">
      {{ typeEnum.get(type) }}
    </header>
    <ul class="blog-ranking-container__content">
      <li @click="router.push(`/e98f/${item.noteid}/ov`)" v-for="(item, i) in list" :key="i">
        <svg v-if="[8].includes(type)" t="1653037677455" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="17435" width="12" height="12"><path d="M487.424 974.848c-8.704 0-17.408-2.048-25.6-6.656C358.4 912.384 232.448 899.072 87.04 883.2l-13.312-1.536c-33.28-3.072-58.368-30.72-58.368-64.512V276.48c0-35.328 29.184-65.024 65.024-66.048 163.84-2.56 306.688 26.624 424.448 87.552 21.504 10.752 35.328 33.792 35.328 57.856V921.6c0 18.944-9.728 36.352-26.112 46.08-8.192 4.608-17.408 7.168-26.624 7.168z m-386.56-713.216H81.408c-8.192 0-14.848 6.656-14.848 14.848v540.672c0 7.168 5.632 13.312 12.8 13.824l13.312 1.536c151.04 15.872 281.088 30.208 393.728 90.624h0.512c0.512 0.512 1.024 0.512 1.536 0s1.024-1.024 1.024-1.536V355.84c0-5.12-3.072-10.24-7.168-12.288-106.496-54.784-234.496-81.92-381.44-81.92z" fill="#8a8a8a" p-id="17436"></path><path d="M544.256 973.312c-9.728 0-19.456-2.56-28.16-8.192-16.896-10.24-27.136-28.16-26.624-48.128V355.328c0-24.576 13.824-47.616 35.84-58.368 117.76-60.416 260.608-90.112 423.936-87.04 35.84 1.024 65.024 30.208 65.024 66.048V816.64c0 33.792-25.088 61.44-58.88 65.024l-20.992 2.56c-141.312 15.36-263.168 29.184-364.032 82.944-8.192 4.096-17.408 6.144-26.112 6.144zM928.768 261.12c-146.432 0-274.432 27.648-380.416 81.92-4.608 2.56-7.68 7.168-7.68 12.8v562.688c0 1.536 0.512 2.56 2.048 3.584s2.56 0.512 3.072 0h0.512c109.568-58.368 236.032-72.192 382.976-88.576l20.992-2.56c7.68-0.512 13.312-6.656 13.312-13.824V275.968c0-8.192-6.656-14.848-14.848-14.848h-19.968z" fill="#8a8a8a" p-id="17437"></path><path d="M386.56 502.272c-3.072 0-6.656-0.512-9.728-2.048-67.584-27.136-136.704-40.96-204.288-40.96-14.336 0-25.6-11.264-25.6-25.6s11.264-25.6 25.6-25.6c74.24 0 149.504 14.848 223.744 45.056 13.312 5.12 19.456 19.968 14.336 33.28-4.096 9.728-13.824 15.872-24.064 15.872z m0 171.52c-3.072 0-6.656-0.512-9.728-2.048-67.584-27.136-136.704-40.96-204.288-40.96-14.336 0-25.6-11.264-25.6-25.6s11.264-25.6 25.6-25.6c74.24 0 149.504 14.848 223.744 45.056 13.312 5.12 19.456 19.968 14.336 33.28-4.096 9.728-13.824 15.872-24.064 15.872z m256.512-171.52c-10.24 0-19.968-6.144-23.552-15.872-5.12-13.312 1.024-28.16 14.336-33.28 73.728-29.696 148.992-45.056 223.744-45.056 14.336 0 25.6 11.264 25.6 25.6s-11.264 25.6-25.6 25.6c-68.096 0-136.704 13.824-204.288 40.96-3.584 1.536-7.168 2.048-10.24 2.048z m0 171.52c-10.24 0-19.968-6.144-23.552-15.872-5.12-13.312 1.024-28.16 14.336-33.28 73.728-29.696 148.992-45.056 223.744-45.056 14.336 0 25.6 11.264 25.6 25.6s-11.264 25.6-25.6 25.6c-68.096 0-136.704 13.824-204.288 40.96-3.584 1.536-7.168 2.048-10.24 2.048z" fill="#8a8a8a" p-id="17438"></path></svg>
        <svg v-if="[6].includes(type)" t="1653039460400" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="22751" width="12" height="12"><path d="M493.789998 1023.53089C254.799718 1023.53089 85.536259 856.015932 85.536259 625.384341c0-122.523033 72.584129-254.513561 75.782607-259.92965a32.11272 32.11272 0 0 1 31.728902-16.162976c12.879205 1.705855 23.156981 11.088057 26.69663 23.540799 0.255878 0.682342 19.87321 74.887033 45.631621 115.955491 17.271782 27.720143 34.970027 47.16689 54.80059 60.81373-13.433608-58.724057-23.626091-147.129991-6.951359-237.668243C358.771578 63.305131 552.514055 3.642853 560.787452 1.21201a31.814195 31.814195 0 0 1 39.831713 36.93176c-0.213232 1.705855-32.325952 175.95894 35.481784 324.410968 6.183724 13.518901 14.712999 29.084827 23.967262 44.906632a422.199104 422.199104 0 0 1 13.135083-66.698929c24.990775-88.022116 89.344154-118.130456 92.116168-119.281909a31.64361 31.64361 0 0 1 32.496537 4.008759c9.382202 7.249884 13.732132 19.276161 11.64246 31.046561-0.341171 2.217611-9.382202 62.178413 41.196398 147.12999 45.674267 76.678181 58.681411 126.403853 58.68141 221.931731C909.123036 856.143872 734.614073 1023.53089 493.789998 1023.53089zM187.247861 475.269104a407.699336 407.699336 0 0 0-28.10396 147.129991c0 187.814632 138.43013 324.069797 334.774036 324.069797 197.879176 0 341.469517-136.255165 341.469518-324.112443 0-81.198696-9.936605-118.684859-48.275696-183.294116-25.587824-43.072838-38.381737-81.795746-44.181643-112.714367a144.272684 144.272684 0 0 0-15.864451 36.803821c-18.721758 66.10188-13.902718 143.718281-13.902718 144.571208a31.259792 31.259792 0 0 1-20.47026 31.259792 30.278926 30.278926 0 0 1-35.225905-11.301289c-2.430843-3.241124-56.975556-81.454575-81.028111-134.336078-49.896258-109.217364-49.213916-227.475759-44.181643-295.539373-50.5786 29.767169-128.408232 96.423452-153.526947 231.868336-24.308433 131.990528 22.943749 269.951548 23.412859 271.23094a31.430378 31.430378 0 0 1-5.586675 31.728902 30.278926 30.278926 0 0 1-30.278925 9.723373c-3.752881-0.93822-96.551391-23.668738-152.460788-112.970245a376.951301 376.951301 0 0 1-26.568691-54.118249z" fill="#707070" p-id="22752"></path></svg>
        <span :style="`margin-left:${[7,9].includes(type) ? '0px' : '12px'}`" class="name">{{item.subtitle}}</span>
        <svg v-if="type === 7" t="1653037799714" class="icon" viewBox="0 0 1066 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="20840" width="14" height="14"><path d="M738.517333 841.557333c0.384 0 3.072 0.981333 4.181334 1.152 4.053333 0 8.490667-4.437333 8.490666-9.216a64.597333 64.597333 0 0 1-2.133333-7.466666l-32.512-204.8a31.914667 31.914667 0 0 1 8.704-27.392l146.432-149.76c1.152-1.322667 4.266667-5.888 2.56-11.093334v-0.085333a8.96 8.96 0 0 0-7.466667-6.058667l-199.936-31.146666a32.085333 32.085333 0 0 1-24.021333-17.962667l-90.069333-191.061333c-3.584-8.277333-12.032-10.410667-17.621334 0.810666L445.44 377.685333a32.042667 32.042667 0 0 1-24.234667 18.005334l-200.234666 29.994666a8.746667 8.746667 0 0 0-6.954667 5.973334c-0.938667 2.858667-0.597333 5.76 0.938667 7.125333l148.010666 151.338667a32.085333 32.085333 0 0 1 8.704 27.648l-35.029333 210.986666c-0.426667 2.474667 0.384 5.930667 3.072 7.594667 3.925333 2.730667 8.490667 3.072 11.349333 1.493333l177.877334-96.213333a31.872 31.872 0 0 1 30.805333 0.213333l178.944 99.882667c-0.213333-0.170667-0.256-0.213333-0.170667-0.213333m3.370667 65.152c-12.458667 0-23.04-4.224-30.72-7.253334l-167.253333-93.098666-162.304 87.722666a73.856 73.856 0 0 1-77.354667-4.437333c-23.04-14.421333-35.541333-42.837333-30.762667-71.381333l32.384-194.944-135.082666-138.197334c-19.2-16.896-26.624-46.506667-17.493334-73.813333 8.533333-25.6 30.677333-44.288 57.685334-48.768l183.808-27.562667 82.773333-175.530666c13.44-26.624 38.144-42.069333 66.56-42.069334 29.696 0 56.021333 16.981333 67.072 43.306667l82.261333 174.464 183.466667 28.586667a73.173333 73.173333 0 0 1 57.984 48.938666c8.704 25.898667 2.517333 54.058667-16.64 75.221334l-136.021333 139.264 29.653333 186.325333c1.536 4.821333 3.285333 11.434667 3.285333 20.053333a73.386667 73.386667 0 0 1-73.301333 73.173334" p-id="20841" fill="#8a8a8a"></path></svg>
        <svg v-if="type === 8" t="1653037556127" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="16451" width="12" height="12"><path d="M512.1 208.4C264.6 208.4 64 343.7 64 510.6s200.6 302.2 448.1 302.2 448.1-135.3 448.1-302.2-200.6-302.2-448.1-302.2zM864 590.1c-17.2 27.4-42.5 52.5-75.3 74.6-34.9 23.5-75.9 42.1-121.9 55.2-48.8 13.9-100.9 21-154.7 21s-105.9-7.1-154.7-21c-46.1-13.1-87.1-31.7-121.9-55.2-32.8-22.1-58.1-47.2-75.3-74.6-16.1-25.6-24.2-52.3-24.2-79.4s8.1-53.8 24.2-79.4c17.2-27.4 42.5-52.5 75.3-74.6 34.9-23.5 75.9-42.1 121.9-55.2 48.8-13.9 100.9-21 154.7-21s105.9 7.1 154.7 21c46.1 13.1 87.1 31.7 121.9 55.2 32.8 22.1 58.1 47.2 75.3 74.6 16.1 25.6 24.2 52.3 24.2 79.4s-8.2 53.8-24.2 79.4z" p-id="16452" fill="#8a8a8a"></path><path d="M512.1 346.2c-90.9 0-164.5 73.7-164.5 164.5s73.7 164.5 164.5 164.5 164.5-73.7 164.5-164.5-73.7-164.5-164.5-164.5z m0 257c-51 0-92.5-41.5-92.5-92.5s41.5-92.5 92.5-92.5 92.5 41.5 92.5 92.5-41.5 92.5-92.5 92.5z" p-id="16453" fill="#8a8a8a"></path></svg>
        <svg v-if="type === 6" t="1653037834734" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="21831" width="12" height="12"><path d="M598.354747 67.542626c-48.148687 0-90.130101 32.905051-98.960808 79.437576 0 0-14.312727 72.882424-21.798787 99.090101-12.308687 43.196768-55.363232 90.944646-86.522829 106.188283-23.531313 11.636364-110.99798 11.765657-116.350707 11.765656H155.707475c-32.762828 0-59.384242 26.479192-59.384243 59.384243v475.022222c0 32.762828 26.479192 59.384242 59.384243 59.384242h548.033939c88.126061 0 163.025455-64.452525 176.135758-151.647676l45.873131-305.713132c10.834747-71.809293-44.8-136.274747-117.423838-136.274747H673.254141s20.066263-66.469495 30.228687-178.669899c5.081212-56.837172-35.167677-110.99798-94.280404-117.152323-3.620202-0.54303-7.227475-0.814545-10.847677-0.814546zM333.705051 898.288485V421.533737c38.917172-2.534141 66.999596-8.016162 83.574949-16.316767 43.726869-21.669495 99.633131-81.040808 117.281616-143.088485 7.899798-27.681616 21.39798-96.155152 23.001212-104.184243 3.47798-17.92 20.596364-31.159596 40.649697-31.159596 1.603232 0 3.206465 0.129293 4.822627 0.271516 28.211717 2.947879 43.326061 29.698586 41.32202 52.686868-9.360808 103.912727-27.823838 166.503434-28.082425 166.904243l-23.130505 76.489697h215.182223c17.519192 0 33.564444 7.356768 45.071515 20.596363 11.507071 13.239596 16.316768 30.228687 13.640404 47.618586L821.294545 797.052121c-8.830707 58.569697-58.181818 101.094141-117.423838 101.094142h-370.165656v0.142222z m-177.997576 0v-475.022222h118.626262v475.022222H155.707475z m0 0" p-id="21832" fill="#707070"></path></svg>
        <span v-if="type === 6">{{item.extData?.star?.length || 0}}</span>
        <span v-if="type === 7">{{item.extData?.take?.length || 0}}</span>
        <span v-if="type === 8">{{item.extData?.skim?.length || 0}}</span>
      </li>
    </ul>
    <footer class="blog-ranking-container__footer" v-if="[9].includes(type)">
      <span></span>
      <el-icon @click="getList"><Refresh /></el-icon>
    </footer>
  </section>
</template>

<script lang="ts" setup>
import {onMounted} from 'vue'
import Api from "@/api";
import { useRouter } from 'vue-router'
import { useState } from '@akar/vue-hooks';
import { Refresh } from '@element-plus/icons-vue'
const svg = `
  <svg t="1653073827880" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="32474" width="32" height="32"><path d="M511.999 89.638C282.053 89.638 95.035 273.4 89.763 502.08c4.884-199.52 156.598-359.646 343.044-359.646 189.526 0 343.169 165.46 343.169 369.566 0 43.738 35.456 79.193 79.193 79.193 43.738 0 79.193-35.455 79.193-79.193 0-233.264-189.097-422.362-422.363-422.362z m0 844.724c229.947 0 416.967-183.763 422.238-412.44-4.884 199.52-156.599 359.645-343.045 359.645-189.527 0-343.17-165.459-343.17-369.566 0-43.737-35.455-79.193-79.192-79.193S89.637 468.263 89.637 512c0 233.266 189.098 422.362 422.362 422.362z" p-id="32475" fill="#a0cfff"></path></svg>
`
const [loading, setLoading] = useState(false)
const props = defineProps<{ type: any }>();
const router = useRouter()
const typeEnum = new Map([
  [6, '热门文章'],
  [7, '社区收藏排行'],
  [8, '社区浏览排行'],
  [9, '好文推荐']
])
const [list, setList] = useState([])

const getList = () => {
  setLoading(true)
  setTimeout(async () => {
    const { data } = await Api.getNoteListPublished({type: props.type});
    setList(data.filter(i => !!i))
    setLoading(false)
  }, 300)
}
onMounted(() => {
  getList()
});
</script>

<style lang="scss" scoped>
.blog-ranking-container {
  position: relative;
  background: #fff;
  overflow: hidden;
  width: 100%;
  height: max-content;
  min-height: 180px;
  margin-bottom: 12px;
  border-radius: 6px;
  box-shadow: 0 0 1px 0 rgba(255, 255, 255, 0.1);
  &__header {
    font-weight: 500;
    padding: 12px 12px 0 12px;
    font-family: Cambria, Cochin, Georgia, Times, 'Times New Roman', serif;
  }
  .hot {
    padding: 6px 12px;
    background-color: var(--xs-color-danger-light-8);
  }
  .pry {
    padding: 6px 12px;
    background-color: var(--xs-color-primary-light-8);
  }
  .link {
    padding: 6px 12px;
    color: var(--xs-color-primary);
  }
  .random {
    transition: .22s;
    padding: 6px 12px;
    background-color: var(--xs-color-success-light-8);
  }
  &__content {
    padding: 12px 0;
    font-family: serif;
    overflow-y: auto;
    li {
      cursor: pointer;
      margin: 2px 0;
      padding: 2px 12px;
      font-size: 12px;
      width: 100%;
      color: #444;
      border-radius: 3px;
      display: flex;
      align-items: center;
      .name {
        max-width: 72%;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
      }
      span {
        display: inline-block;
        margin: 0 12px;
      }
      &:hover {
        background-color: var(--xs-color-warning-light-9);
      }
    }
  }
  &__footer {
    padding: 12px;
    position: absolute;
    left: 0;
    bottom: 0;
    width: 100%;
    height: 36px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    i:hover {
      cursor: pointer;
      color: var(--xs-color-primary-dark-2)
    }
  }
}
</style>
